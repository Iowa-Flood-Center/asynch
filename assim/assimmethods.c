#include "assimmethods.h"

//Computes the Eigendecomposition of the symmetric matrix A.
//Note: This destroys the contents of A.
void Diagonalize(MAT* A,MAT* V,VEC* D,int* isuppz)
{
	lapack_int info,eigsfound,il,iu;
	double vl,vu,abstol;
	
	il = iu = 0;
	vl = vu = 0.0;
	abstol = -1.0;

	info = LAPACKE_dsyevr( LAPACK_ROW_MAJOR, 'V', 'A', 'U',
                           A->m, A->array, A->m, vl,
                           vu, il, iu,
                           abstol, &eigsfound, D->ve, V->array,
                           A->m, isuppz );

	if(info != 0 || eigsfound < (int)(A->m))	printf("Warning: info is %i and eigsfound is %i.\n",info,eigsfound);
}

//Computes the Eigendecomposition of the symmetric matrix A in parallel.
//Note: This destroys the contents of A.
void Parallel_Diagonalize(MAT* Alocal,MAT* Vlocal,VEC* D,int* desca,int* descz,VEC* work,IVEC* iwork)
{
	int info,eigvalsfound,eigvecsfound,il,iu,ia,ja,iz,jz;
	double garbage;
	char jobz,range,uplo;
	int m = desca[2];
	eigvalsfound = -1;

	jobz = 'V';
	range = 'A';
	uplo = 'L';

	ia = ja = 1;
	il = iu = m;
	iz = jz = 1;

	pdsyevr_(&jobz,&range,&uplo,&m,Alocal->array,&ia,&ja,desca,
		&garbage,&garbage,&il,&iu,&eigvalsfound,&eigvecsfound,D->ve,Vlocal->array,&iz,
		&jz,descz,work->ve,(int*)&(work->dim),iwork->ve,(int*)&(iwork->dim),
		&info);

	if(info != 0 || eigvalsfound < m)	printf("Warning: info is %i and eigvalsfound is %i.\n",info,eigvalsfound);
}


//Takes a picture of the current system state. Assumes backup is stored by location !!!! This is wasteful !!!!.
void GetState(Link** sys,unsigned int* my_sys,unsigned int N,unsigned int my_N,int* assignments,UnivVars* GlobalVars,double* backup)
{
	unsigned int i,j;
	unsigned int dim = GlobalVars->dim;

	for(i=0;i<my_N;i++)
		for(j=0;j<dim;j++)
			backup[my_sys[i]*dim+j] = sys[my_sys[i]]->list->tail->y_approx->ve[j];

	//Broadcast the data
	if(np > 1)
	{
		for(i=0;i<N*dim;i+=dim)
			MPI_Bcast(&backup[i],dim,MPI_DOUBLE,assignments[i/dim],MPI_COMM_WORLD);
	}
}

//Restores the data in backup to sys.
void ApplyState(Link** sys,unsigned int N,UnivVars* GlobalVars,double* backup,double backup_time)
{
	unsigned int i,j,k;
	unsigned int dim = GlobalVars->dim;
	Link* current;

	//Reset sys
	for(i=0;i<N;i++)
	{
		current = sys[i];
		if(current->list != NULL)
		{
			while(current->current_iterations > 1)
			{
				Remove_Head_Node(current->list);
				(current->current_iterations)--;
			}
			current->list->head->t = backup_time;
			current->last_t = backup_time;
			current->steps_on_diff_proc = 1;
			current->iters_removed = 0;
			current->rejected = 0;
			if(current->numparents == 0)	current->ready = 1;
			else				current->ready = 0;
			for(j=0;j<dim;j++)
				current->list->tail->y_approx->ve[j] = backup[current->location*dim+j];
			CheckConsistency(current->list->tail->y_approx,dim,GlobalVars->type,current->params,GlobalVars->global_params);

			if(current->rain != NULL)
			{
				//Find the right index in rainfall
				for(j=0;j<current->rain->n_times;j++)
					if(current->rain->rainfall[j][0] <= backup_time && backup_time < current->rain->rainfall[j+1][0])	break;
				double rainfall_buffer = current->rain->rainfall[j][1];
				current->rain_value = rainfall_buffer;

				//Find and set the new change in rainfall
				for(k=j+1;k<current->rain->n_times;k++)
				{
					if(current->rain->rainfall[k][1] != rainfall_buffer)
					{
						current->rain_change_time = current->rain->rainfall[k][0];
						break;
					}
				}
				if(k == current->rain->n_times)
					current->rain_change_time = current->rain->rainfall[k-1][0];
			}
		}
	}
}

//Read into memory the times and discharges stored in a .dat file.
double*** ReadSolution(char filename[],unsigned int* numlinks,unsigned int** ids,unsigned int** numsteps)
{
	unsigned int i,j,k,dim;
	double*** data;

	FILE* file = fopen(filename,"r");
	if(!file)
	{
		printf("Error reading true solution. File %s not found.\n",filename);
		abort();
	}

	//Setup data structures
	fscanf(file,"%u%u",numlinks,&dim);
/*
	if(dim != 1 && dim != 2)
	{
		printf("Invalid type in ReadSolution.\n");
		abort();
	}
*/
/*
	fscanf(file,"%u%u",numlinks,&type);
	switch(type)
	{
		case 0:	dim = 1;
			break;
		case 1: dim = 2;
			break;
		default: printf("Invalid type in ReadSolution\n");
			 abort();
	}
*/
	*ids = (unsigned int*) malloc(*numlinks*sizeof(unsigned int));
	*numsteps = (unsigned int*) calloc(*numlinks,sizeof(unsigned int));	
	data = (double***) malloc(*numlinks*sizeof(double**));

	//Read in the file
	for(i=0;i<*numlinks;i++)
	{
		fscanf( file,"%u %u",&((*ids)[i]),&((*numsteps)[i]) );
		data[i] = (double**) malloc((*numsteps)[i]*sizeof(double*));
		for(j=0;j<(*numsteps)[i];j++)
		{
			data[i][j] = (double*) malloc(2*sizeof(double));
			fscanf(file,"%lf %lf",&(data[i][j][0]),&(data[i][j][1]));	//time and discharge
			for(k=2;k<dim+1;k++)	fscanf(file,"%*f");
		}
	}

	//Cleanup
	fclose(file);
	return data;
}

//Returns the discharge for link id at time t.
//!!!! Could this be given the location instead of id? !!!!
double FindDischarge(double*** data,unsigned int id,double t,unsigned int numlinks,unsigned int* ids,unsigned int* numsteps,double stddev)
{
	unsigned int i,min,max,found_loc;
	double TWO_PI = 2.0 * 3.141592653589;
	double val;

	//Find the location of the id
	for(i=0;i<numlinks;i++)
	{
		if(ids[i] == id)
		{
			found_loc = i;
			break;
		}
	}
	if(i == numlinks)
	{
		printf("Link id %u not found.\n",id);
		return -1.0;
	}

	//Find the time
	i = numsteps[found_loc]/2;
	max = numsteps[found_loc];
	min = 0;
	if(t > data[found_loc][numsteps[found_loc]-1][0])
		i = max-1;
	else
	{
		while( t*.99999 > data[found_loc][i][0] || t*1.00001 < data[found_loc][i][0] )
		{
			if(data[found_loc][i][0] < t)	min = i;
			else				max = i;
			i = (max+min)/2;

			if(min == max)
			{
				printf("Time %f not found.\n",t);
				return -1.0;
			}
		}
	}

	//val = data[found_loc][i][1] + stddev*sqrt(-2.0*log( (rand()%100000)/100000.0 + .00000001 ))*cos(TWO_PI * ((rand()%100000)/100000.0 + .00000001));
	//if(val < 0.0)	val = 0.0;

val = data[found_loc][i][1];

	return val;
}

double Functional(MAT* B,MAT* R,VEC* d,VEC* analysis,VEC* background)
{
	unsigned int i;
	MAT* Binv = m_get(B->m,B->n);
	MAT* Rinv = m_get(R->m,R->n);
	int* ipiv = (int*) malloc(B->m*sizeof(int));
	VEC* difference = v_get(analysis->dim);
	double energy;

	//Invert B
	m_copy(B,Binv);
	clapack_dgetrf(CblasRowMajor,Binv->m,Binv->n,Binv->array,Binv->m,ipiv);
	clapack_dgetri(CblasRowMajor,Binv->m,Binv->array,Binv->m,ipiv);

	//Invert R
	for(i=0;i<R->m;i++)
		Rinv->me[i][i] = 1.0/R->me[i][i];

	//Compute functional
	v_sub(analysis,background,difference,0);
	energy = vTAv(Binv,difference);
	energy += vTAv(Rinv,d);

	//Clean up
	m_free(Binv);
	m_free(Rinv);
	free(ipiv);
	v_free(difference);

	return energy;
}

//Determines the number of processes to place each row and col for CBlacs.
//Tries to make process grid as close to square as possible.
//Note that if np is prime, the resulting grid is very lam3.
void FindNPRowCol(int* nprow,int* npcol)
{
	unsigned int i;
	unsigned int sqroot = (unsigned int) rint(pow((double) np,0.5));

	for(i=sqroot;i>0;i--)
	{
		if(np % i == 0)
		{
			*nprow = i;
			*npcol = np / i;
			break;
		}
	}

	if(i == 0)
	{
		printf("%i: Error determining nprow and npcol.\n",my_rank);
		*nprow = *npcol = -1;
	}
}


void SetMat(MAT* A)
{
	unsigned int i,j;
	unsigned int m = A->m;
	unsigned int n = A->n;

	if(m != 22 || n != 10)
	{
		printf("Warning: Not setting matrix in function SetMat, wrong dimensions. m = %u n = %u\n",m,n);
		return;
	}


	double matrix[22][10] = { {10.0000731479037785, 10.0000395118389918, 9.9999896703961308, 10.0001693200583102, 10.0000164713472959, 9.9999238555523835, 10.0001024185073462, 10.0002024448025306, 10.0001350700066762, 10.0001512478392307},
				{0.0003160266231540, -0.0007698004573338, 0.0006885948102831, -0.0005761044285653, -0.0002225764648436, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, -0.0010836367969490, -0.0003772045102041},
				{10.0000202683197443, 10.0001978816926034, 9.9998597800683182, 10.0000054798055764, 9.9998764965102982, 10.0000167795483303, 9.9999830286815339, 9.9999853370909833, 10.0002008072843918, 9.9999828163334321},
				{0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, -0.0006601152410507, 0.0000000000000000, 0.0000000000000000, 0.0010093878673203, 0.0018922534576468, 0.0000000000000000},
				{9.9999321009270776, 9.9999643813558095, 10.0000057287718835, 10.0000305407364589, 10.0001225887732712, 10.0000385892109289, 10.0000060646492894, 9.9998597877426363, 9.9998834074184408, 10.0001566687835091},
				{-0.0017081253331259, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000233626216123, 0.0000000000000000, 0.0000000000000000, -0.0000351634906364, 0.0007254312554447, -0.0010648338157791},
				{10.0000959360931567, 10.0000277081136595, 10.0001812320676997, 10.0000373661461222, 9.9999941107563490, 9.9999159558547941, 10.0001734244903258, 10.0000611659072653, 9.9998578337421833, 10.0000771475022496},
				{0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000128114295744, -0.0002812361958429, 0.0000000000000000},
				{10.0000166737672505, 10.0000595153189131, 10.0001174063765621, 9.9999554360901062, 9.9998400092832309, 10.0001135072652154, 10.0000738706215131, 9.9999469320378225, 9.9998879737259880, 9.9999934286711039},
				{0.0000000000000000, -0.0009771691169652, 0.0000000000000000, -0.0006870250762399, 0.0000000000000000, -0.0002928795064338, -0.0011005898672935, -0.0013105914033241, 0.0009787155740574, 0.0000000000000000},
				{10.0000330131056110, 9.9998468247670971, 10.0001800311716096, 9.9999951257148645, 10.0000584386232738, 10.0001315885314686, 10.0000024795929736, 10.0000172723195675, 10.0000542118163818, 9.9999747930725285},
				{0.0000000000000000, 0.0000000000000000, 0.0000000000000000, -0.0010370745070047, 0.0003321542235944, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, -0.0003305206092553, 0.0000000000000000},
				{9.9999035133350436, 10.0000234649370459, 9.9999702836174897, 9.9998542313802865, 10.0000717886870749, 9.9999944716655715, 9.9999994205291376, 10.0000455130971915, 9.9999717737787464, 9.9999203177831788},
				{0.0000000000000000, -0.0007562193468123, 0.0000000000000000, 0.0000000000000000, 0.0008350290787981, 0.0006083261076496, 0.0000967328173839, 0.0000000000000000, 0.0004355628961617, -0.0004266124439987},
				{9.9999821505950770, 9.9998415058082397, 10.0001030350941242, 10.0001897833747968, 9.9998889705715470, 10.0000564738578710, 9.9999562223141041, 9.9999568309457665, 10.0000339634248103, 10.0000121723588382},
				{0.0000000000000000, 0.0003317134364287, 0.0000000000000000, -0.0016260384550760, 0.0011817079657895, -0.0003952721175883, -0.0015427454464087, 0.0000000000000000, 0.0000000000000000, 0.0015748515840134},
				{9.9999016074715090, 9.9999540998230110, 9.9999437868939012, 9.9998138299706838, 9.9999986568255927, 10.0000077719032188, 10.0000217464402130, 10.0000430504528133, 9.9999931333606771, 9.9999498643341251},
				{0.0008576573686940, 0.0000000000000000, 0.0000000000000000, 0.0004479805242651, 0.0000000000000000, 0.0000000000000000, -0.0001313187121911, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000},
				{10.0000440083110629, 9.9999223970852817, 9.9999970652387447, 10.0000147053718607, 10.0000265422902075, 10.0000096641263507, 9.9999767159734478, 9.9999775850846451, 9.9998919830453108, 10.0000311712034584},
				{0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0003848865272940, 0.0000000000000000, 0.0000000000000000, -0.0027566756418566, 0.0000000000000000, 0.0000000000000000},
				{9.9999991995101727, 10.0001690535217183, 9.9999388322796161, 10.0001367920519115, 9.9999900117410139, 9.9999395608078707, 10.0000954445066625, 10.0000165767206290, 10.0001125344096060, 10.0000513704608114},
				{0.0000000000000000, 0.0003221264802256, -0.0004586556480880, -0.0004619539283614, -0.0004625376822171, 0.0000000000000000, 0.0019149172417004, 0.0000000000000000, -0.0000603267725045, 0.0000000000000000} };


/*
double matrix[22][20] = { { 10.0000746578879003, 9.9997936954675168, 9.9999516212751729, 10.0001404628955477, 9.9999468247289727, 10.0000709581274787, 10.0000661932734420, 9.9998753743290347, 9.9998438530736262, 9.9998801337905370, 10.0000400709798338, 10.0000364054995128, 9.9998029765321803, 9.9997208352157099, 9.9998096452254188, 9.9998647833462986, 10.0000201142651299, 9.9999569506917965, 10.0001149856666434, 10.0000869409139650},
{ 0.0000000000000000, 0.0000000000000000, -0.0012544768940815, 0.0013699006611616, -0.0000315408352302, -0.0003660304394913, -0.0007786823386533, -0.0016647554936598, -0.0009954813250209, 0.0000000000000000, 0.0008359243727520, 0.0000000000000000, 0.0003288572584271, -0.0012412369291571, 0.0000000000000000, -0.0007754710191561, 0.0000000000000000, 0.0003295597482655, -0.0008537476620622, -0.0003393862165220},
{ 9.9999898325619316, 9.9999749656693080, 9.9998674671619234, 9.9998964632395086, 9.9998831438224496, 10.0001566180708323, 9.9998902875260800, 10.0000293659354149, 10.0001027074153281, 10.0000702279386111, 9.9998113126525574, 10.0000785152806468, 10.0000355389225533, 10.0000423446317033, 9.9999091983986830, 9.9998146236782830, 9.9999402248752602, 9.9999003986784079, 10.0001029222780300, 9.9997650166039023},
{ -0.0003659412671627, 0.0001390359068818, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0015729969999742, 0.0003045394856535, 0.0000390929792951, -0.0005016502538995, -0.0001027786953532, 0.0002402107770726, 0.0000000000000000, 0.0000000000000000, 0.0014629662188549, 0.0010123541669359, 0.0000000000000000, -0.0012980799906788, 0.0012065159007751, 0.0000000000000000, 0.0000000000000000},
{ 10.0000424319005177, 10.0001035417476540, 10.0000000128757254, 10.0000535231596785, 10.0000247749651123, 10.0002120578574303, 9.9999306668965211, 9.9999387783195548, 9.9997250771187627, 9.9998516665243073, 9.9998936487577605, 9.9998562755541283, 9.9998648292686720, 9.9998749256504471, 10.0000300851104207, 10.0000549861966714, 10.0000037287459111, 10.0000737450752872, 9.9999495354835641, 10.0000592159617216},
{ 0.0004366490671985, -0.0000312086965222, 0.0000000000000000, 0.0000000000000000, -0.0011502467055875, 0.0002338984935045, -0.0002068544272846, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0018174954740680, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, -0.0004087898800251, 0.0006029090637400, 0.0000000000000000, -0.0006908595042328},
{ 10.0000345537809974, 10.0002943309087318, 9.9999533410884371, 9.9999478043584613, 10.0000110083252700, 10.0000455299335265, 9.9999397879894136, 9.9999637549177915, 9.9999511423279284, 10.0000337269380619, 9.9999923939910662, 9.9998051553835570, 9.9999487767450805, 10.0000351495559858, 10.0000224324671994, 10.0000184458178563, 10.0000526014099744, 9.9999535372575821, 9.9998928678069259, 9.9999414612166593},
{ -0.0013335055247449, 0.0000000000000000, 0.0006945910290011, 0.0000000000000000, -0.0003831952920678, 0.0000000000000000, -0.0002007899512112, 0.0013542088368747, 0.0000000000000000, 0.0000000000000000, -0.0005523573420726, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, -0.0008470705309998, 0.0015728131410214, -0.0001417927068216, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000},
{ 9.9998973794451871, 9.9999995050183532, 10.0000003453286546, 9.9999802417891228, 10.0001073475043913, 10.0001009186404008, 9.9999179042193269, 10.0000600740705750, 9.9998849016897786, 9.9999629591869539, 10.0000773275573209, 9.9998965904853723, 9.9997454687409153, 10.0000847274899947, 9.9999727665115845, 9.9999254153148804, 10.0000654866720140, 10.0002120757955364, 9.9999574336473955, 10.0000058478050988},
{ 0.0012765228586621, -0.0008048067983782, 0.0000000000000000, 0.0007259512444016, 0.0000000000000000, 0.0000661184219227, 0.0000000000000000, 0.0000000000000000, 0.0010902854085298, 0.0005019151740241, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0004371520849378, 0.0018505093184751, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000650085510271},
{ 10.0000766731906463, 10.0001851357783433, 10.0000329749328429, 10.0002422017383612, 10.0000266713327015, 10.0000967852445992, 10.0000168991752325, 10.0000246101938437, 9.9999586013469397, 9.9999478538636701, 10.0001450187279861, 9.9999140201729038, 9.9998805130133519, 9.9999803425805744, 10.0001734410953116, 9.9999672136775590, 10.0002505966718847, 9.9999474398825718, 9.9999824934619461, 10.0001398589886783},
{ 0.0000000000000000, -0.0000501699840604, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, -0.0002429449201364, -0.0001495260829888, 0.0016931002420990, 0.0001139808817346, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, -0.0000727543109493, 0.0006994374759369, -0.0027178861983475, 0.0000000000000000, 0.0000000000000000},
{ 9.9999781042012792, 10.0000128215905963, 9.9999447583511731, 9.9999960987616330, 10.0000256375267025, 10.0000292801219395, 10.0000439159142829, 9.9999552810241159, 9.9998850887470994, 9.9999205092371231, 10.0000468782316272, 10.0000024771769631, 9.9999212149254237, 9.9999298103792125, 10.0000394315346313, 9.9998183663976388, 10.0000298996744679, 9.9999679210911872, 10.0000226233126490, 9.9999563823987607},
{ 0.0000000000000000, 0.0004208083910132, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, -0.0006999864961766, -0.0006606293878487, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0001894991468714, -0.0009097776509772, 0.0001894894856971, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, -0.0004685063539655, -0.0011842905720455},
{ 10.0000753162152041, 9.9998868553848403, 9.9998563490904644, 9.9998977528402051, 10.0001221532524784, 9.9998419716002847, 9.9999770808517106, 9.9999864132842369, 9.9999556630900219, 9.9998549526356086, 9.9999348812212610, 9.9999972595887563, 10.0000112652200421, 10.0001934905649534, 10.0000995994656705, 9.9999971914199168, 10.0002173792093032, 10.0000561482955987, 9.9998830707167379, 9.9999548678041315},
{ 0.0000582597694623, 0.0001651351770703, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0015871480448074, 0.0000000000000000, 0.0005111000834335, 0.0015340042660500, -0.0001012559547027, 0.0000000000000000, 0.0000000000000000, 0.0013962571651684, 0.0000000000000000, 0.0026184519250593, 0.0000000000000000, -0.0014897231496003, 0.0000000000000000, 0.0000000000000000, -0.0004994635615823},
{ 10.0000302381096429, 10.0001460728717486, 9.9999350676768746, 9.9999970741305333, 10.0000016739680131, 9.9999396847495774, 9.9999345897352079, 9.9999928038269328, 9.9998912606808545, 9.9999963522350370, 10.0000611176345249, 9.9998501477948682, 10.0001163296905151, 9.9999767159940518, 10.0000072704938336, 9.9999556834294694, 9.9999946082880040, 10.0000614038537314, 9.9998859513325709, 10.0000371924562668},
{ 0.0000000000000000, 0.0001088538238933, 0.0000000000000000, -0.0002210978353190, 0.0011040795051007, -0.0005119158764786, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0011322591191730, -0.0001297423495736, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, -0.0008750621213678, 0.0010851363410961, -0.0009893786650666, -0.0010282021809093},
{ 9.9999151694066502, 10.0001427570034966, 10.0000932884039013, 9.9998084972556640, 10.0001360534145025, 9.9999002146908467, 10.0001627548816767, 9.9998653842362693, 9.9999790272939766, 9.9999321669866710, 9.9998860315689200, 9.9999455539505462, 9.9999764335436030, 9.9999752844189871, 10.0000273884886148, 9.9999335001175620, 10.0000318854507118, 9.9999739929329312, 9.9999221304660431, 10.0000911668176542},
{ 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, -0.0006232167891017, 0.0000000000000000, 0.0000062809559964, 0.0007330957308193, 0.0012167434489160, -0.0019814053430205, 0.0000000000000000, 0.0015110567982761, -0.0003075990727667, 0.0000000000000000, 0.0019683503218338, 0.0000836067650160, -0.0007854133715370, 0.0000000000000000, 0.0023790953338965, 0.0000726004322995, 0.0000000000000000},
{ 9.9999446317945662, 10.0001192542556439, 10.0001129723218352, 10.0001504160639563, 10.0000714946840610, 9.9998730751226095, 10.0000221031976384, 9.9999950928283781, 9.9998814012297021, 10.0001132027037745, 10.0000376781318590, 9.9998703244792608, 9.9998650630836767, 9.9998656904693668, 10.0000604020996384, 9.9999527539049371, 9.9998204929324395, 10.0000057681572159, 10.0000010422507870, 9.9999818458452090},
{ -0.0003234202164811, -0.0004259706784850, 0.0003081597406713, 0.0000000000000000, 0.0000000000000000, 0.0012465956342253, 0.0000000000000000, -0.0004375652239196, 0.0000601334744574, 0.0006408692212502, 0.0000000000000000, 0.0000000000000000, 0.0028223018376001, -0.0025751912030592, -0.0011040124773908, 0.0000000000000000, -0.0004657588745687, 0.0000000000000000, 0.0016911270536365, -0.0001303111753775} };
*/
/*
double matrix[6][10] = { { 9.9998741391292398, 10.0000250072020691, 9.9997854326075117, 10.0000857536474470, 9.9999450687863209, 9.9999087113689473, 10.0000039110475605, 9.9998907182561414, 9.9999953027088182, 9.9999408535265992},
{ -0.0007298622344464, -0.0003337329556212, 0.0001896804983600, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0003005647964412, -0.0000466302526197},
{ 9.9999739431018924, 9.9998992792710819, 9.9999118519862176, 10.0001430628712136, 9.9998392098506539, 9.9998601022648028, 9.9999964629299321, 10.0001322286841550, 9.9997972183921604, 10.0001555512590397},
{ 0.0004896234151776, 0.0015895262987929, 0.0004326449661419, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000},
{ 10.0001806544878917, 9.9999541203050626, 10.0000427446059845, 10.0000294413570625, 9.9999825174541783, 10.0000269092989384, 10.0000251034885643, 9.9999489919241533, 9.9999723148729416, 10.0000876742745355},
{ -0.0007533307384290, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, -0.0011857003232032, 0.0000000000000000, -0.0007287366159193, 0.0008397218431518, -0.0009031090987515} };
*/
/*
double matrix[6][5] = { { 10.0000578661128472, 10.0000001049072633, 9.9999335324924541, 9.9999804607859559, 9.9999011093645915},
{ 0.0000000000000000, 0.0012738151068052, 0.0000000000000000, 0.0001124704082338, 0.0005876237830516},
{ 10.0001025970475865, 10.0003165137286665, 10.0001419971365930, 9.9999191065408386, 9.9999287977277564},
{ 0.0000000000000000, 0.0000000000000000, 0.0013460647959159, 0.0006958050532030, -0.0011225821110219},
{ 9.9998805443757472, 9.9999220092933978, 9.9998243966874085, 9.9999754548118940, 9.9999842501628180},
{ -0.0006852954773796, -0.0011323002292488, -0.0002952096752726, 0.0000000000000000, 0.0003654638849141}};
*/
/*
double  matrix[4][5] = { { 9.9999706861409052, 9.9998253484198347, 9.9998988303716008, 10.0000232592914937, 9.9999825162495188},
{ 0.0000000000000000, 0.0017466376136011, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000},
{ 10.0000575520991433, 9.9999652975527056, 10.0001234777235126, 10.0000384429945779, 9.9998472638075118},
{ 0.0000000000000000, 0.0020045309499759, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000} };
*/
	for(i=0;i<m;i++)
	{
		for(j=0;j<n;j++)
			A->me[i][j] = matrix[i][j];
	}
}


